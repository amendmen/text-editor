(function(t){function e(e){for(var i,r,c=e[0],l=e[1],o=e[2],u=0,h=[];u<c.length;u++)r=c[u],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&h.push(a[r][0]),a[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);d&&d(e);while(h.length)h.shift()();return n.push.apply(n,o||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,c=1;c<s.length;c++){var l=s[c];0!==a[l]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=s[0]))}return t}var i={},a={app:0},n=[];function r(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=i,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(s,i,function(e){return t[e]}.bind(null,i));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/text-editor/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var o=0;o<c.length;o++)e(c[o]);var d=l;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},1403:function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var i=s("2b0e"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}]},[s("Editor",{attrs:{selected:t.selectedElement},on:{valueChanged:function(e){return t.onValueChanged(e)}}}),s("TextContent",{attrs:{data:t.data},on:{mouseDown:function(e){return t.onMouseDown(e)},mouseUp:function(e){return t.onTextSelected(e)}}})],1),s("json-viewer",{attrs:{value:t.data,"expand-depth":5}})],1)},n=[],r=(s("99af"),s("4de4"),s("c740"),s("4160"),s("c975"),s("fb6a"),s("a434"),s("d3b7"),s("ac1f"),s("25f0"),s("466d"),s("5319"),s("1276"),s("159b"),s("2909")),c=s("ade3"),l=s("5530"),o=s("c28b"),d=s.n(o),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.selected?s("div",{staticClass:"editor"},[s("Select",{attrs:{type:"fontSize",options:t.fontSizes,selected:t.selected?t.selected.fontSize:null},on:{valueChanged:function(e){return t.$emit("valueChanged",e)}}},[t._v("font size")]),s("Select",{attrs:{type:"color",options:t.colors,selected:t.selected?t.selected.color:null},on:{valueChanged:function(e){return t.$emit("valueChanged",e)}}},[t._v("color")]),s("Select",{attrs:{type:"bcgColor",options:t.colors,selected:t.selected?t.selected.bcgColor:null},on:{valueChanged:function(e){return t.$emit("valueChanged",e)}}},[t._v("bacground")])],1):s("div",{staticClass:"notselected"},[t._v("text not selected")])},h=[],f=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"select"},[s("label",{attrs:{for:""}},[t._t("default")],2),s("select",{domProps:{value:t.selected},on:{change:function(e){return t.onSelectChange(e)}}},t._l(t.options,(function(e,i){return s("option",{key:i,style:["fontSize"!=t.type?{background:e}:{},"black"==e?{color:"white"}:{}],domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0)])},p=[],x={props:{type:{type:String,required:!0},options:{type:Array,required:!0},selected:{type:String,required:!1}},methods:{onSelectChange:function(t){this.$emit("valueChanged",{type:this.type,value:t.target.value})}}},v=x,g=(s("5eb5"),s("2877")),b=Object(g["a"])(v,f,p,!1,null,null,null),O=b.exports,m={props:{selected:{type:Object,required:!1}},components:{Select:O},data:function(){return{colors:["red","gold","white","black","green","pink","blue"],fontSizes:["40px","45px","50px","55px","60px","65px"]}}},y=m,S=(s("8eb9"),Object(g["a"])(y,u,h,!1,null,null,null)),j=S.exports,w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-content"},t._l(t.data,(function(e,i){return s("span",{key:i,style:t.getStyles(e),on:{mousedown:function(e){return t.$emit("mouseDown",i)},mouseup:function(e){return t.$emit("mouseUp",i)}}},[t._v(t._s(e.text))])})),0)},C=[],_={props:{data:{type:Array,required:!0}},methods:{getStyles:function(t){var e={color:t.color,fontSize:t.fontSize,backgroundColor:t.bcgColor};return e}}},k=_,T=(s("c508"),Object(g["a"])(k,w,C,!1,null,null,null)),E=T.exports,D={name:"App",components:{Editor:j,TextContent:E},mounted:function(){window.addEventListener("keyup",this.handleKeyUp)},data:function(){return{data:[{text:"My lovely little Ponny",fontSize:"45px",color:"black",bcgColor:"pink"}],selectedText:"",selectedElement:null,cursorOffset:null,start:null,end:null}},directives:{clickOutside:d.a.directive},methods:{onMouseDown:function(t){var e=this;setTimeout((function(){e.start=t,e.cursorOffset=window.getSelection().anchorOffset}))},handleKeyUp:function(t){if(t.preventDefault(),null!=this.start){var e=t.keyCode;if(e>47&&e<58||32==e||13==e||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223)this.data[this.start].text=this.data[this.start].text.slice(0,this.cursorOffset)+t.key+this.data[this.start].text.slice(this.cursorOffset),this.cursorOffset++;else if(8==e){if(0==this.cursorOffset&&0==this.start)return;0==this.cursorOffset&&(this.start--,this.cursorOffset=this.data[this.start].text.length),this.data[this.start].text=this.data[this.start].text.slice(0,this.cursorOffset-1)+this.data[this.start].text.slice(this.cursorOffset),this.cursorOffset--}else if(46==e){if(this.start==this.data.length-1&&this.cursorOffset==this.data[this.start].text.length)return;this.cursorOffset==this.data[this.start].text.length&&(this.start++,this.cursorOffset=0),this.data[this.start].text=this.data[this.start].text.slice(0,this.cursorOffset)+this.data[this.start].text.slice(this.cursorOffset+1)}this.regroupData()}},onValueChanged:function(t){var e=this;if(this.selectedElement){var s=this.data.findIndex((function(t){return t.text==e.selectedText}));-1!=s?this.data[s][t.type]=t.value:this.updateData(t),this.regroupData()}},onTextSelected:function(t){if(window.getSelection()){if(this.selectedElement=null,this.selectedText=window.getSelection().toString(),this.end=t,this.start>this.end){var e=this.end;this.end=this.start,this.start=e}this.checkTextParams()}},checkTextParams:function(){this.selectedElement=this.data[this.start]},updateData:function(t){this.start==this.end&&this.selectedText.length<this.data[this.start].text.length?this.updateDataSingleElement(t):this.updateMultipleElements(t),this.cancelSelection()},updateDataSingleElement:function(t){var e=this.data[this.start].text.indexOf(this.selectedText),s=Object(l["a"])(Object(l["a"])({},this.data[this.start]),{},Object(c["a"])({text:this.selectedText},t.type,t.value));if(e+this.selectedText.length==this.data[this.start].text.length)this.data[this.start].text=this.data[this.start].text.replace(this.selectedText,""),this.data=[].concat(Object(r["a"])(this.data.slice(0,this.start+1)),[s],Object(r["a"])(this.data.slice(this.start+1)));else if(0==e)this.data[this.start].text=this.data[this.start].text.replace(this.selectedText,""),this.data=[].concat(Object(r["a"])(this.data.slice(0,this.start)),[s,this.data[this.start]],Object(r["a"])(this.data.slice(this.start+1)));else{var i=Object(l["a"])({},this.data[this.start]);i.text=i.text.substring(0,e);var a=Object(l["a"])({},this.data[this.start]);a.text=a.text.substring(e+s.text.length),this.data=[].concat(Object(r["a"])(this.data.slice(0,this.start)),[i,s,a],Object(r["a"])(this.data.slice(this.start+1)))}},updateMultipleElements:function(t){var e=Object(l["a"])(Object(l["a"])({},this.data[this.start]),{},Object(c["a"])({text:this.selectedText},t.type,t.value));if(this.end-this.start>1){var s=this.data.slice(this.start+1,this.end),i="";s.forEach((function(t){i+=t.text}));var a=this.selectedText.split(i),n=Object(l["a"])({},this.data[this.start]);n.text=n.text.replace(a[0],"");var o=Object(l["a"])({},this.data[this.end]);o.text=o.text.replace(a[1],""),this.data=[].concat(Object(r["a"])(this.data.slice(0,this.start)),[n,e,o],Object(r["a"])(this.data.slice(this.end+1)))}else{var d=this.findSelectedFragmentIndex(this.data[this.start].text,this.selectedText.slice(0,-1));if(-1==d)return void this.cancelSelection();var u=Object(l["a"])({},this.data[this.start]);u.text=u.text.slice(0,d);var h=this.data[this.start].text.length-u.text.length,f=Object(l["a"])({},this.data[this.end]);f.text=f.text.slice(h),this.data=[].concat(Object(r["a"])(this.data.slice(0,this.start)),[u,e,f],Object(r["a"])(this.data.slice(this.end+1)))}},regroupData:function(){for(var t=0;t<this.data.length;t++){var e=this.data[t],s=this.data[t+1];s&&e.color==s.color&&e.fontSize==s.fontSize&&e.bcgColor==s.bcgColor&&(this.data[t].text+=s.text,this.data.splice(t+1,1),t--)}this.data=this.data.filter((function(t){return""!==t.text}))},cancelSelection:function(){this.selectedText=null,this.selectedElement=null,this.start=null,this.end=null,this.cursorOffset=null,window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges()},findSelectedFragmentIndex:function(t,e){if(e){var s=t.match(e);return s?s.index:this.findSelectedFragmentIndex(t,e.slice(0,-1))}return-1},onClickOutside:function(){this.cancelSelection()}}},P=D,z=(s("5c0b"),Object(g["a"])(P,a,n,!1,null,null,null)),$=z.exports,M=s("349e"),q=s.n(M);i["default"].use(q.a),i["default"].config.productionTip=!1,new i["default"]({render:function(t){return t($)}}).$mount("#app")},"5c0b":function(t,e,s){"use strict";s("9c0c")},"5eb5":function(t,e,s){"use strict";s("d448")},"8eb9":function(t,e,s){"use strict";s("1403")},"9c0c":function(t,e,s){},c508:function(t,e,s){"use strict";s("fe13")},d448:function(t,e,s){},fe13:function(t,e,s){}});
//# sourceMappingURL=app.032001a0.js.map